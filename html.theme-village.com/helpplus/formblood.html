<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Blood Donation Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS v5.3 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- intl-tel-input CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css"
    />

    <style>
      .input-group-text {
        background-color: #ffc107;
        color: #fff;
        font-weight: 600;
      }
      .btn-action {
        background-color: #fff;
        color: #212529;
        border: 1px solid #212529;
        border-radius: 50px;
        padding: 0.75rem 2rem;
        font-weight: 600;
        transition: background-color 0.2s ease;
      }
      .btn-action:hover,
      .btn-action:focus,
      .btn-action:active {
        background-color: #ffc107;
        outline: none;
      }
    </style>
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card shadow-sm">
            <div class="card-body">
              <h4 class="mb-4 text-center">Blood Donation Registration</h4>

              <form id="donationForm" class="needs-validation" novalidate>
                <!-- Email -->
                <div class="mb-3">
                  <label for="email" class="form-label"
                    >Email <span class="text-danger">*</span></label
                  >
                  <input
                    type="email"
                    class="form-control"
                    id="email"
                    name="email"
                    required
                  />
                  <div class="invalid-feedback">Enter a valid email.</div>
                </div>

                <!-- Phone -->
                <div class="mb-3">
                  <label for="phone" class="form-label"
                    >Phone Number <span class="text-danger">*</span></label
                  >
                  <input
                    id="phone"
                    type="tel"
                    class="form-control"
                    name="phone"
                    required
                  />
                  <div class="invalid-feedback" id="phoneFeedback">
                    Enter a valid Jordanian phone number.
                  </div>
                </div>

                <!-- Blood Type Dropdown -->
                <div class="mb-3">
                  <label for="bloodType" class="form-label"
                    >Blood Type <span class="text-danger">*</span></label
                  >
                  <select
                    id="bloodType"
                    name="bloodType"
                    class="form-select"
                    required
                  >
                    <option value="" disabled selected>
                      Select your blood type
                    </option>
                    <option value="A+">A+</option>
                    <option value="A-">A–</option>
                    <option value="B+">B+</option>
                    <option value="B-">B–</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB–</option>
                    <option value="O+">O+</option>
                    <option value="O-">O–</option>
                  </select>
                  <div class="invalid-feedback">
                    Please select your blood type.
                  </div>
                </div>

                <!-- Date of Arrival -->
                <div class="row mb-3">
                  <label class="form-label col-12">
                    Date of arrival at the hospital<span class="text-danger"
                      >*</span
                    >
                  </label>
                  <div class="col-4">
                    <select
                      class="form-select dob"
                      id="dobDay"
                      name="dobDay"
                      required
                    >
                      <option value="" disabled selected>Day</option>
                    </select>
                    <div class="invalid-feedback">Select day.</div>
                  </div>
                  <div class="col-4">
                    <select
                      class="form-select dob"
                      id="dobMonth"
                      name="dobMonth"
                      required
                    >
                      <option value="" disabled selected>Month</option>
                      <option value="1">January</option>
                      <option value="2">February</option>
                      <option value="3">March</option>
                      <option value="4">April</option>
                      <option value="5">May</option>
                      <option value="6">June</option>
                      <option value="7">July</option>
                      <option value="8">August</option>
                      <option value="9">September</option>
                      <option value="10">October</option>
                      <option value="11">November</option>
                      <option value="12">December</option>
                    </select>
                    <div class="invalid-feedback">Select month.</div>
                  </div>
                  <div class="col-4">
                    <select
                      class="form-select dob"
                      id="dobYear"
                      name="dobYear"
                      required
                    >
                      <option value="" disabled selected>Year</option>
                    </select>
                    <div class="invalid-feedback">Select year.</div>
                  </div>
                </div>

                <!-- Expected Time of Arrival -->
                <div class="row mb-4">
                  <label class="form-label col-12">
                    Expected Time of Arrival<span class="text-danger"
                      >*</span
                    >
                  </label>
                  <div class="col-6">
                    <select
                      class="form-select"
                      id="etaHour"
                      name="etaHour"
                      required
                    >
                      <option value="" disabled selected>Hour</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10</option>
                      <option value="11">11</option>
                      <option value="12">12</option>
                    </select>
                    <div class="invalid-feedback">Select hour.</div>
                  </div>
                  <div class="col-6">
                    <select
                      class="form-select"
                      id="etaAMPM"
                      name="etaAMPM"
                      required
                    >
                      <option value="" disabled selected>AM/PM</option>
                      <option value="AM">AM</option>
                      <option value="PM">PM</option>
                    </select>
                    <div class="invalid-feedback">Select AM or PM.</div>
                  </div>
                </div>

                <!-- Password -->
                <div class="mb-3">
                  <label for="password" class="form-label"
                    >Password <span class="text-danger">*</span></label
                  >
                  <input
                    type="password"
                    class="form-control"
                    id="password"
                    name="password"
                    minlength="8"
                    pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^\w\s]).{8,}"
                    required
                  />
                  <div class="invalid-feedback" id="pwFeedback">
                    Must be ≥8 chars, include uppercase, lowercase, number & symbol.
                  </div>
                </div>

                <!-- Submit -->
                <div class="text-center">
                  <button type="submit" id="signupBtn" class="btn btn-action">
                    Submit
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS & intl-tel-input JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Populate DOB selects
        const daySel = document.getElementById("dobDay"),
          yearSel = document.getElementById("dobYear"),
          currentYear = new Date().getFullYear();
        for (let d = 1; d <= 31; d++) daySel.add(new Option(d, d));
        for (let y = currentYear; y >= 1900; y--) yearSel.add(new Option(y, y));

        const form = document.getElementById("donationForm"),
          phoneIn = document.getElementById("phone"),
          phoneFB = document.getElementById("phoneFeedback");

        // intl-tel-input initialization
        const iti = window.intlTelInput(phoneIn, {
          initialCountry: "jo",
          preferredCountries: ["jo"],
          utilsScript:
            "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
        });

        // Custom phone validation
        function validateJordanPhone(number) {
          const digits = number.replace(/\D/g, "");
          return /^07[7-9]\d{7}$/.test(digits);
        }

        // Form submit
        form.addEventListener("submit", (e) => {
          let valid = form.checkValidity();
          if (!iti.isValidNumber() || !validateJordanPhone(phoneIn.value)) {
            phoneIn.setCustomValidity("Invalid phone");
            phoneFB.style.display = "block";
            valid = false;
          } else {
            phoneIn.setCustomValidity("");
            phoneFB.style.display = "none";
          }
          if (!valid) {
            e.preventDefault();
            e.stopPropagation();
            form.classList.add("was-validated");
          }
        });
      });
    </script>
  </body>
</html>
